{"version":3,"file":"pages/index/index.js","sources":["webpack:///./src/pages/index/index.vue?1497","webpack:///._src_pages_component_infiniteloading.vue","webpack:///._src_pages_index_index.vue","webpack:///./src/pages/component/infiniteloading.vue?6358","webpack:///./src/pages/index/index.vue?0e79","webpack:///./src/pages/component/infiniteloading.vue?9087","webpack:///./src/pages/component/infiniteloading.vue?a9ae","webpack:///./src/pages/component/infiniteloading.vue?010b","webpack:///./src/pages/component/infiniteloading.vue?8928","webpack:///./src/pages/index/index.vue?e724","webpack:///./src/pages/index/index.vue?5b58","webpack:///./src/pages/index/index.vue?d348","webpack:///./src/pages/index/index.vue?550b"],"sourcesContent":["import { render } from \"./index.vue?vue&type=template&id=1badc801\"\nimport script from \"./index.vue?vue&type=script&lang=js\"\nexport * from \"./index.vue?vue&type=script&lang=js\"\n\nimport \"./index.vue?vue&type=style&index=0&id=1badc801&lang=scss\"\n\nimport exportComponent from \"E:\\\\工作室项目\\\\Taro-picture-library-demo-main\\\\node_modules\\\\vue-loader\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__file',\"src/pages/index/index.vue\"]])\n/* hot reload */\nif (module.hot) {\n  __exports__.__hmrId = \"1badc801\"\n  const api = __VUE_HMR_RUNTIME__\n  module.hot.accept()\n  if (!api.createRecord('1badc801', __exports__)) {\n    console.log('reload')\n    api.reload('1badc801', __exports__)\n  }\n  \n  module.hot.accept(\"./index.vue?vue&type=template&id=1badc801\", () => {\n    console.log('re-render')\n    api.rerender('1badc801', render)\n  })\n\n}\n\n\nexport default __exports__","<template>\r\n  <view class=\"index\">\r\n    <view v-if=\"loading\">\r\n      <nut-button loading>加载中</nut-button>\r\n    </view>\r\n    <view v-else>\r\n      <view class=\"infiniteUl\" id=\"scrollDemo\">\r\n        <nut-infiniteloading\r\n          pull-icon=\"JD\"\r\n          load-txt=\"loading\"\r\n          load-more-txt=\"没有啦～\"\r\n          :is-open-refresh=\"true\"\r\n          container-id=\"scrollDemo\"\r\n          :has-more=\"hasMore\"\r\n          @load-more=\"loadMore\"\r\n        >\r\n          <view\r\n            class=\"infiniteLi\"\r\n            v-for=\"(item, index) in picture\"\r\n            :key=\"index\"\r\n          >\r\n            <img\r\n              :src=\"`https://picsum.photos/id/${item.id}/200`\"\r\n              @click=\"toDetail(index)\"\r\n              class=\"resize\"\r\n            />\r\n            <view>{{ index + \"-\" + item.author }}</view>\r\n          </view>\r\n        </nut-infiniteloading>\r\n      </view>\r\n    </view>\r\n  </view>\r\n</template>\r\n\r\n<script>\r\nimport { ref, computed, onMounted } from \"vue\";\r\nimport { useStore } from \"vuex\";\r\nimport Taro from \"@tarojs/taro\";\r\nexport default {\r\n  name: \"Index\",\r\n  setup() {\r\n    Taro.pxTransform(10);\r\n    const store = useStore();\r\n    const loading = ref(false);\r\n    const page = computed(() => store.state.page);\r\n    const hasMore = ref(true);\r\n    const picture = computed(() => store.state.pictures);\r\n    const loadMore = async (done) => {\r\n      loading.value = true;\r\n      store.state.page = store.state.page + 1;\r\n      const res = store.dispatch(\"LOAD_PICTURE_MUTATIONS\", {\r\n        page: page.value,\r\n      });\r\n      loading.value = false;\r\n      // done();\r\n    };\r\n    const getStoreData = () => {\r\n      let value = Taro.getStorageSync(\"data\");\r\n      if (value.length != 0) {\r\n        if (store.state.pictures) {\r\n          store.commit(\"loadingAll\", value);\r\n        }\r\n        return true;\r\n      }\r\n      return false;\r\n    };\r\n    const toDetail = (id) => {\r\n      if (id != null) {\r\n        Taro.navigateTo({\r\n          url: `/pages/detail/index?id=${id}`,\r\n        });\r\n      }\r\n    };\r\n    onMounted(async () => {\r\n      loadMore();\r\n      await getStoreData();\r\n    });\r\n    return {\r\n      loading,\r\n      picture,\r\n      toDetail,\r\n      loadMore,\r\n      hasMore,\r\n    };\r\n  },\r\n};\r\n</script>\r\n\r\n<style lang=\"scss\">\r\n.infiniteUl {\r\n  height: 600px;\r\n  width: 375px;\r\n  overflow-y: auto;\r\n  overflow-x: hidden;\r\n}\r\n.infiniteLi {\r\n  margin-top: 10px;\r\n  font-size: 14px;\r\n  color: rgba(100, 100, 100, 1);\r\n  text-align: center;\r\n}\r\n.loading {\r\n  display: block;\r\n  width: 100%;\r\n  text-align: center;\r\n}\r\n.resize {\r\n  max-width: 100%;\r\n  height: 300px;\r\n  width: 95%;\r\n  margin: 10px;\r\n  border-radius: 8px;\r\n  box-shadow: 0 13px 27px -5px hsl(240deg 30% 28% / 25%),\r\n    0 8px 16px -8px hsl(0deg 0% 0% / 30%), 0 -6px 16px -6px hsl(0deg 0% 0% / 3%);\r\n}\r\n</style>\r\n","<template>\n  <view class=\"index\">\n    <view v-if=\"loading\">\n      <h1>欢迎使用picture-library</h1>\n      <img :src=\"`https://picsum.photos/id/1/200`\" class=\"resize\" />\n      <nut-button class=\"loginButton\" @click=\"login()\"\n        >微信用户一键登录</nut-button\n      >\n      <nut-toast\n        :msg=\"page.state.msg\"\n        v-model:visible=\"page.state.show\"\n        :type=\"page.state.type\"\n        @closed=\"page.methods.onClosed\"\n        :cover=\"page.state.cover\"\n      />\n    </view>\n    <view v-else>\n      <component-a></component-a>\n    </view>\n  </view>\n</template>\n\n<script>\nimport { ref, reactive } from \"vue\";\nimport ComponentA from \"../component/infiniteloading.vue\";\nimport Taro from \"@tarojs/taro\";\nimport { useStore } from \"vuex\";\nexport default {\n  name: \"Index\",\n  components: { \"component-a\": ComponentA },\n  setup() {\n    const page = {\n      state: reactive({\n        msg: \"toast\",\n        type: \"text\",\n        show: false,\n        cover: false,\n      }),\n      methods: {\n        openToast: (type, msg, cover = false) => {\n          page.state.show = true;\n          page.state.msg = msg;\n          page.state.type = type;\n          page.state.cover = cover;\n        },\n        onClosed: () => console.log(\"closed\"),\n      },\n    };\n    const store = useStore();\n    const loading = ref(true);\n    // const loginUrl = \"http://192.168.195.144:2333/login\";\n    // const getInfoUrl = \"http://192.168.195.144:2333/user/fav\";\n    // const setInfoUrl = \"http://192.168.195.144:2333/user/fav\";\n    const loginUrl = \"http://10.1.86.79:1919/login\";\n    const getInfoUrl = \"http://10.1.86.79:1919/user/fav\";\n    const setInfoUrl = \"http://10.1.86.233:2333/user/fav\";\n    const switchInterface = (id) => {\n      if (id === \"shoucang\") {\n        Taro.switchTab({\n          url: \"/collect\",\n        });\n      }\n    };\n    // 关闭app时发出post请求将数据储存到数据库中\n    Taro.onAppHide(() => {\n      if (store.state.collectPhotos.length > 0) {\n        Taro.request({\n          url: setInfoUrl,\n          data: {\n            favList: JSON.stringify(store.state.collectPhotos),\n            nickName: Taro.getStorageSync(\"userinfo\").userInfo.nickName,\n            signature: Taro.getStorageSync(\"openid\"),\n          },\n          method: \"post\",\n        });\n      }\n    });\n    const login = () => {\n      Taro.getUserProfile({\n        desc: \"用于登录\", // 声明获取用户个人信息后的用途，后续会展示在弹窗中，请谨慎填写\n        success: (userinfo) => {\n          // 用户名的储存\n          Taro.setStorageSync(\"userinfo\", userinfo);\n          Taro.login({\n            success: (res) => {\n              if (res.code) {\n                // 后端端口以及第一次请求需要的数据参数\n                const loginData = {\n                  js_code: res.code,\n                  appid: \"wx276fa88d4f970b4d\",\n                  secret: \"baccb969de5fdaf4b32f5e68742cda3b\",\n                };\n                // 发送第一次请求\n                Taro.request({\n                  url: loginUrl,\n                  data: loginData,\n                  success: (res) => {\n                    Taro.setStorageSync(\"openid\", res.data.openid);\n                    Taro.request({\n                      url: getInfoUrl,\n                      data: {\n                        nickName: userinfo.userInfo.nickName,\n                        signature: res.data.openid,\n                      },\n                      success: (res) => {\n                        Taro.setStorageSync(\"data\", res.data.data);\n                        loading.value = false;\n                      },\n                    });\n                  },\n                });\n              } else {\n                console.log(\"登录失败！\" + res.errMsg);\n              }\n            },\n          });\n        },\n      });\n    };\n    return {\n      switchInterface,\n      login,\n      loading,\n      page,\n    };\n  },\n};\n</script>\n\n<style lang=\"scss\">\n.index {\n  font-family: \"Avenir\", Helvetica, Arial, sans-serif;\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n  text-align: center;\n  line-height: height;\n}\n.loginButton {\n  width: 90%;\n  display: inline-block;\n  border-radius: 2cm;\n  background-color: green;\n  color: white;\n}\n</style>\n","// extracted by mini-css-extract-plugin","// extracted by mini-css-extract-plugin","import { render } from \"./infiniteloading.vue?vue&type=template&id=10ea1a7c\"\nimport script from \"./infiniteloading.vue?vue&type=script&lang=js\"\nexport * from \"./infiniteloading.vue?vue&type=script&lang=js\"\n\nimport \"./infiniteloading.vue?vue&type=style&index=0&id=10ea1a7c&lang=scss\"\n\nimport exportComponent from \"E:\\\\工作室项目\\\\Taro-picture-library-demo-main\\\\node_modules\\\\vue-loader\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__file',\"src/pages/component/infiniteloading.vue\"]])\n/* hot reload */\nif (module.hot) {\n  __exports__.__hmrId = \"10ea1a7c\"\n  const api = __VUE_HMR_RUNTIME__\n  module.hot.accept()\n  if (!api.createRecord('10ea1a7c', __exports__)) {\n    console.log('reload')\n    api.reload('10ea1a7c', __exports__)\n  }\n  \n  module.hot.accept(\"./infiniteloading.vue?vue&type=template&id=10ea1a7c\", () => {\n    console.log('re-render')\n    api.rerender('10ea1a7c', render)\n  })\n\n}\n\n\nexport default __exports__","export { default } from \"-!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/vue-loader/dist/index.js??ref--10-0!./infiniteloading.vue?vue&type=script&lang=js\"; export * from \"-!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/vue-loader/dist/index.js??ref--10-0!./infiniteloading.vue?vue&type=script&lang=js\"","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js!../../../node_modules/css-loader/dist/cjs.js??ref--1-oneOf-0-1!../../../node_modules/vue-loader/dist/stylePostLoader.js!../../../node_modules/postcss-loader/dist/cjs.js??ref--1-oneOf-0-2!../../../node_modules/resolve-url-loader/index.js!../../../node_modules/sass-loader/dist/cjs.js??ref--1-oneOf-0-4!../../../node_modules/vue-loader/dist/index.js??ref--10-0!./infiniteloading.vue?vue&type=style&index=0&id=10ea1a7c&lang=scss\"","export * from \"-!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/vue-loader/dist/templateLoader.js??ref--6!../../../node_modules/vue-loader/dist/index.js??ref--10-0!./infiniteloading.vue?vue&type=template&id=10ea1a7c\"","import { createPageConfig } from '@tarojs/runtime'\nimport component from \"../../../node_modules/@tarojs/taro-loader/lib/raw.js!./index.vue\"\nvar config = {\"navigationBarTitleText\":\"首页\"};\n\n\nvar inst = Page(createPageConfig(component, 'pages/index/index', {root:{cn:[]}}, config || {}))\n\n","export { default } from \"-!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/vue-loader/dist/index.js??ref--10-0!./index.vue?vue&type=script&lang=js\"; export * from \"-!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/vue-loader/dist/index.js??ref--10-0!./index.vue?vue&type=script&lang=js\"","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js!../../../node_modules/css-loader/dist/cjs.js??ref--1-oneOf-0-1!../../../node_modules/vue-loader/dist/stylePostLoader.js!../../../node_modules/postcss-loader/dist/cjs.js??ref--1-oneOf-0-2!../../../node_modules/resolve-url-loader/index.js!../../../node_modules/sass-loader/dist/cjs.js??ref--1-oneOf-0-4!../../../node_modules/vue-loader/dist/index.js??ref--10-0!./index.vue?vue&type=style&index=0&id=1badc801&lang=scss\"","export * from \"-!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/vue-loader/dist/templateLoader.js??ref--6!../../../node_modules/vue-loader/dist/index.js??ref--10-0!./index.vue?vue&type=template&id=1badc801\""],"mappings":";;;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAcA;AACA;AACA;AACA;;;;;;;;;;;;;;;;;;;;;;;ACSA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AACA;AACA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AADA;AAGA;AACA;AAPA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AADA;AAAA;AAAA;AAAA;AACA;AAQA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AAAA;AACA;AACA;AAAA;AACA;AACA;AACA;AADA;AAGA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AADA;AAAA;AACA;AADA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAIA;AACA;AACA;AACA;AACA;AACA;AALA;AAOA;AA9CA;;;;;;;;;;;;;ACfA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAJA;AAMA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AAPA;AAPA;AAiBA;AACA;AAEA;AACA;AACA;AAAA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AADA;AAGA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAHA;AAKA;AAPA;AASA;AACA;AACA;AAAA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAHA;AACA;AAKA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAFA;AAIA;AACA;AACA;AACA;AATA;AAWA;AAhBA;AAkBA;AACA;AACA;AACA;AA/BA;AAiCA;AAtCA;AAwCA;AACA;AAAA;AACA;AACA;AACA;AACA;AAJA;AAMA;AAlGA;;;;;;;;;;;;;;;;;;AD1BA;;;;;;AAEA;AACA;;;;;AAEA;AAAA;;;;;;;;AALA;AAEA;AAAA;AAAA;AAAA;AAAA;;;;AAAA;AAKA;AACA;AACA;AACA;AACA;AACA;AACA;AAcA;AAVA;AAAA;AAFA;AACA;AAEA;AAQA;AALA;AACA;AAAA;AAAA;AACA;AACA;;AAJA;AAKA;AAAA;AACA;;AAXA;AAEA;;;;AAXA;;AAAA;;;;;;;;;;;;;;;;;;ACNA;;;;;;AAEA;AAAA;AAAA;AACA;;;AAEA;AACA;;;;;;;;;;;AANA;AAGA;AAAA;AAAA;;AAAA;AACA;AAAA;AAAA;AAAA;AAEA;AADA;AAAA;AAAA;;;;AADA;AAIA;AACA;;AAAA;AAIA;AAHA;AACA;AACA;AACA;;AANA;;;;;;;;;;;;ACRA;;;;;;;;;;;ACAA;;;;;;;;;;;;;ACAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAcA;AACA;AACA;AACA;;;;;;;;;;;;;AC1BA;AAAA;AAAA;AAAA;;;;;;;;;;;;ACAA;AAAA;AAAA;;;;;;;;;;;;;;ACAA;AAAA;AAAA;;;;;;;;;;;;;;ACAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;ACNA;AAAA;AAAA;AAAA;;;;;;;;;;;;ACAA;AAAA;AAAA;;;;;;;;;;;;;;ACAA;AAAA;AAAA;;;;;A","sourceRoot":""}